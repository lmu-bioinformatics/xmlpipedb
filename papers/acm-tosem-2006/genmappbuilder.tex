\subsection{GenMAPP Builder}
\label{gmbuilder}

\subsubsection{Introduction}
GenMAPP Builder is a GUI application for loading, querying, and exporting data
used by GenMAPP.

\subsubsection{Design}

GenMAPP Builder is also tasked to export GO data from postgres to a Microsoft Access (MDB) file.
GenMAPP requires four GO tables to be populated with data: GeneOntology,
GeneOntologyTree, GeneOntologyCount, and Uniprot-GeneOntology. At runtime, each table
is created in the MDB file prior to any data extraction.
The following sections will discuss each table.

\paragraph{GeneOntology}
\label{gotable}
The GeneOntology table consists of a list of GO terms, which is created by extracting all the
GO terms from postgres database by executing HQL statements. Each term has required tags, \emph{Id} and \emph{Name}.
Each term may contain optional tags, one of which is an \emph{is\_a} tag. An \emph{is\_a} tag describes a
subclassing relationship between one term and another. Since GO terms
are organized in structures called directed acyclic graphs (DAG), each term may have many \emph{is\_a} relationships.
Terms with no \emph{is\_a} relationships are roots. Each term represents an entry in the GeneOntology table. If a term
has no \emph{is\_a} relationships, then one row is inserted into the table. If a term has one or more
\emph{is\_a} relationships, a row is inserted for each \emph{is\_a} relationships using the same term Id.


\paragraph{GeneOntologyTree}
The GeneOntologyTree table contains a tree representation of the GO DAG structure, which is used by MAPPFinder
to build the GO tree in the MAPPFinder browser. The algorithm that creates this table starts by inserting the root
node for each ontology. After inserting the root node, it then grabs all the children of that node and perform an insert.
For each child, it grabs its children
and performs an insert. This process continues recursively, and stops when no more child nodes exist.
Unfortunately, this table is not created from postgres, but rather from the
newly created table in Section~\ref{gotable}. The OBO.dtd file creates a SQL DDL schema which does not support
the ability to extract child nodes from a parent node. The GeneOntology table provides this functionality, which
is why it must be created first. Thus, the algorithm actually queries the MDB Access file using SQL statements.


\paragraph{GeneOntologyCount}
The GeneOntologyCount table contains the of number of times a GO ID appears in the GeneOntologyTree table, which
is also used by MAPPFinder to build the GO tree in the MAPPFinder browser. During the creating of the GeneOntologyTree
table, a count of each GO ID is stored in a data structure. In other words, when the algorithm grabs all child nodes from
a parent, each child node's count is increment by 1. When the GeneOntologyTree table is complete, the count for
each GO ID is extracted from the data structure and inserted into the GeneOntologyCount table.
This method was used to ``kill two birds with one stone". Otherwise,
the algorithm would have to wait until the GeneOntologyTree table was complete. Then for each GO ID, the algorithm would have
to query the GeneOntologyTree to extract the number of times it showed up in the table, which is costly and inefficient.


\paragraph{Uniprot-GeneOntology}
The Uniprot-GeneOntology table provides a mapping between a Uniprot ID and a GO ID, which is a many to many relationship.
Currently this information is not found in godb, but rather in a associations text file which is part of the GenMAPP Builder
resource library. Each line in the text file may contain a Uniprot ID. If it does, then there will be one to many GO ID's.
Thus, for each GO ID, a new row is created in the Uniprot-GeneOntology table with the Uniprot ID as one field and the GO ID
as another field. For example, if the line contained a Uniprot ID of \emph{00001} and three GO ID's \emph{10001,10002, and 10003},
then three row would be created with values ``00001 10001", ``00001 10002", and ``00001 10003."

\subsubsection{Performance Analysis}
A couple of GO errors occurred during the first run of gmbuilder: two table fields are named \emph{Primary} and \emph{Level}, which
Microsoft Access interpreted as keywords. Additionally, the hyphen in the table \emph{Uniprot-GeneOntology}
was recognized  as a continuation line, and therefore a syntax error was generated. Fortunately, the same fix was used
in all three cases: enclose each name in double quotes. After the fix was implemented, gmbuilder successfully built the
GO tables in the MDB file, which took considerable time.

The time to build the four GO tables ran in the neighborhood of five hours (2.0GHz single processor), and
granted, this time can be shorten with better hardware. A big chunk of that time falls on the creation of the
GeneOntologyTree, although this table contains roughly seven time more entries than the table with the second
most entries. Still, it seemed that the rate of insertions per second was larger.
A good test would be to time, call it T, the creation of the
GeneOntology table by itself, than take the number of entries that were created and divide it by T. Then do the same for the
GeneOntologyTree, and compare the rate of insertions per second. If they are approximately the same, then the increased time
is due to the increase in entries. But, if the GeneOntologyTree insertion rate was much higher, than further investigation would be
needed to why the rate is slower. Perhaps it's due to the recursive nature of the algorithm, since recursion increases overhead.


\subsubsection{Future Work}
Regarding the GO tables, the algorithm that populates the GeneOntologyTree table should be investigated.
If it turns out that the GeneOntologyTree insertion rate in considerable larger that the other tables, then
a couple of solutions can be analyzed: 1) create an equivalent non-recursive function to build the tree. This
eliminates the added overhead of recursion; 2) the code can be cleaned up to
close \emph{Statement} objects before the next call to the recursive function is made. Also, the code can
be modified to use \emph{PreparedStatement} object as opposed to \emph{Statement} objects, which may be more
efficient according the java API.


As of right now, Uniprot-GeneOntology associations file is defined at a specific location in the build tree,
and the code reflects that by hardcoding the path to the file. This is error prone: every time the file changes location,
the code would also have to change, which supports poor coding practices. Also, what is the user wanted to use a different
associations file? Then the file would have to be checked in as a new resource file, and a new version of the software would have
to be released. The solution is to make this file user selectable from the genMAPP Builder GUI. This eliminate the two problems
above, while add flexibility to the user.
