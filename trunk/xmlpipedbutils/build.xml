<!-- Buildfile for the Hana compiler -->

<project name="XmlPipeDbUtilities" default="jar">
  <property name="jarfilename" value="xpdUtils"/>
  <property name="mainclass" value="app.XmlPipeDbUtils"/>
  <property name="resources" value="resources"/>
  <property name="project.title" value="GUI to XML Pipe DB"/>
  <property name="src.dir" value="src"/>
  <property name="lib.dir" value="lib"/>	
  <property name="build.dir" value="build"/>
  <property name="dist.dir" value="dist"/>
  <property name="javadoc.dir" value="javadocs"/>
  
  <target name="clean" description="Remove generated files">
    <delete dir="${build.dir}"/>
    <delete dir="${dist.dir}"/>
    <delete dir="${javadoc.dir}"/>
   <delete>
      <!-- Delete temporary files from test dir 
      	e.g.: assembly, object, and executables from test dir -->
      <fileset dir="test" includes="*.asm,*.o,*.obj,*.exe"/>
    </delete>
  </target>
  
  <target name="init">
    <mkdir dir="${build.dir}"/>
    <mkdir dir="${dist.dir}"/>
    <tstamp/>
  </target>
  
  <target name="javadoc" description="Generate JavaDocs" depends="compile">
    <delete dir="${javadoc.dir}"/>
    <mkdir dir="${javadoc.dir}"/>
    <javadoc 
      sourcepath="${src.dir}"
      destdir="${javadoc.dir}"
      packagenames="*"
      doctitle="&lt;h1&gt;${project.title} API Documentation&lt;/h1&gt;"
    />
  </target>
  
  <target name="compile" depends="init">
    <javac srcdir="${src.dir}" destdir="${build.dir}"/>
    <!-- Copy the resource file, since it is needed at runtime. -->
    <copy todir="${build.dir}/${resources}">
      <fileset dir="${src.dir}/${resources}" includes="**/*.properties"/>
    </copy>
  </target>
  
  <target name="jar" depends="compile" 
    description="Makes a jar file for the application">
    <jar destfile="${dist.dir}/${jarfilename}.jar"
       basedir="${build.dir}"
       excludes="**/*Tester*.class,**/*.java">
       <manifest>
         <attribute name="Main-Class" value="${mainclass}"/>
       </manifest>
     </jar>
    <copy todir="${dist.dir}/lib">
      <fileset dir="${lib.dir}/" includes="**/*.jar"/>
    </copy>
  </target>

<!-- BUILD APPLICATION SPECIFIC TESTERS, VIEWERS, ETC. -->
<!--  
  <target name="test" depends="compile" description="Runs unit tests">
    <java 
      classname="hana.FrontEndTester" 
      dir="${build.dir}" 
      fork="true" 
      failonerror="true"
    />
  </target>
-->
<!--
  <target name="viewer" depends="compile" description="Runs the GUI viewer">
	<java 
	  classname="hana.Viewer" 
	  dir="${build.dir}" 
	  fork="true" 
	  failonerror="false"
	/>
  </target>
-->
  <target name="all" depends="javadoc, jar" description="Initializes, Compiles, makes Jar and creates JavaDocs"/>  
</project>
